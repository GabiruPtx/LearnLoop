{% extends "public/templates/main.html" %}
{% load static %}

{% block title %}Learn Loop - Página Principal{% endblock %}

{% block content %}
<div class="config-header">
    <a href="{% url 'public:index' %}?projeto_id={{ project.id }}" class="back-button">
        <img src="{% static 'public/images/Arrow left.svg' %}" alt="Voltar">
    </a>
    <h1>Configurações</h1>
</div>

<div class="config-container">
    <aside class="config-sidebar">
        <nav id="config-tabs">
            <a href="#" class="nav-link active" data-tab="config-projeto">
                <img src="{% static 'public/images/Settings.svg' %}" alt=""> Configurações do Projeto
            </a>
            <a href="#" class="nav-link" data-tab="acesso-papeis">
                <img src="{% static 'public/images/Users.svg' %}" alt=""> Configurar acesso e papéis
            </a>
            <a href="#" class="nav-link" data-tab="prioridade">
                <img src="{% static 'public/images/Plus square.svg' %}" alt=""> Prioridade
            </a>
            <a href="#" class="nav-link" data-tab="tamanho">
                <img src="{% static 'public/images/Plus square.svg' %}" alt=""> Tamanho
            </a>
            <a href="#" class="nav-link" data-tab="iteracao-sprint">
                <img src="{% static 'public/images/Pie chart.svg' %}" alt=""> Iteração/Sprint
            </a>
            <a href="#" class="nav-link" data-tab="milestone">
                <img src="{% static 'public/images/milestone.svg' %}" alt=""> Milestone
            </a>
            <a href="#" class="nav-link" data-tab="fluxo-trabalho">
                <img src="{% static 'public/images/Git branch.svg' %}" alt=""> Fluxo de trabalho
            </a>
            <a href="#" class="nav-link" data-tab="arquivados">
                <img src="{% static 'public/images/Archive.svg' %}" alt=""> Arquivados
            </a>
        </nav>
    </aside>

    <div class="config-content">
        <div id="config-projeto" class="tab-pane active">
            <h2 class="config-content-title">Configurações do Projeto</h2>
            <form>
                <div class="form-group">
                    <label for="projectName">Nome do projeto</label>
                    <input type="text" class="form-control" id="projectName" value="{{ project.nome }}">
                </div>
                <div class="form-group">
                    <label for="projectDescription">Descrição curta</label>
                    <textarea class="form-control" id="projectDescription" rows="3">{{ project.descricao }}</textarea>
                </div>
                <div class="form-group">
                    <label for="readmeEditor">README</label>
                    <textarea id="readmeEditor"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Salvar Alterações</button>
            </form>
            
            
            <div class="sensitive-options">
                <h3>OPÇÕES SENSÍVEIS</h3>
                <div class="option-item">
                    <div>
                        <strong>Fechar projeto</strong>
                        <p>Fechar este projeto irá desabilitar os workflows e removerá o acesso dos alunos.</p>
                    </div>
                    <button class="btn btn-danger">Fechar Projeto</button>
                </div>
                <div class="option-item">
                    <div>
                        <strong>Deletar projeto</strong>
                        <p>Uma vez deletado, o projeto é excluído permanentemente. Por favor tenha certeza de sua escolha.</p>
                    </div>
                    <button class="btn btn-danger">Deletar Projeto</button>
                </div>
            </div>
        </div>

        <div id="acesso-papeis" class="tab-pane">
            <h2 class="config-content-title">Configurar Acesso e Papéis</h2>
            <p>Conteúdo para configurar acesso e papéis...</p>
        </div>
        <div id="prioridade" class="tab-pane">
            <h2 class="config-content-title">Prioridade</h2>
            <p>Defina as tags de prioridade que podem ser atribuídas às tarefas do seu projeto. Arraste para reordenar.</p>

            <div class="priority-settings-container">
                <div class="priority-list-header">
                    <span>Opção</span>
                    <span>Descrição</span>
                </div>
                <ul id="priority-list" class="priority-list">
                    {# Os itens existentes serão renderizados aqui pelo Django #}
                    <li class="priority-item" data-id="1" draggable="true">
                        <div class="priority-handle">::</div>
                        <div class="priority-tag-container">
                            <span class="priority-tag p-red" data-color-class="p-red">P0</span>
                        </div>
                        <div class="priority-description">
                            <input type="text" value="Alta prioridade. DEVE ser concluído ao final do Sprint" readonly>
                        </div>
                        <button class="priority-options-btn">...</button>
                    </li>
                    <li class="priority-item" data-id="2" draggable="true">
                        <div class="priority-handle">::</div>
                        <div class="priority-tag-container">
                            <span class="priority-tag p-orange" data-color-class="p-orange">P1</span>
                        </div>
                        <div class="priority-description">
                            <input type="text" value="Média prioridade, tem que estar pronto o quanto antes e trabalhado com atenção" readonly>
                        </div>
                        <button class="priority-options-btn">...</button>
                    </li>
                    <li class="priority-item" data-id="3" draggable="true">
                        <div class="priority-handle">::</div>
                        <div class="priority-tag-container">
                            <span class="priority-tag p-yellow" data-color-class="p-yellow">P2</span>
                        </div>
                        <div class="priority-description">
                            <input type="text" value="Baixa prioridade, deve ser feita em tempo hábil, mas não impacta no progresso geral da sprint ou pode ser postergada" readonly>
                        </div>
                        <button class="priority-options-btn">...</button>
                    </li>
                </ul>

                <div class="add-priority-form">
                    <input type="text" id="newPriorityInput" class="form-control" placeholder="Adicionar nome da prioridade...">
                    <button id="addPriorityBtn" class="btn btn-secondary">Adicionar</button>
                </div>
            </div>

            <div id="priority-options-menu" class="options-menu">
                <div class="menu-item" id="edit-priority-option"><img src="{% static 'public/images/Settings.svg' %}" alt=""> Editar Tag</div>
                <div class="menu-item danger" id="remove-priority-option"><img src="{% static 'public/images/Archive.svg' %}" alt=""> Remover Tag</div>
            </div>

            <div id="editPriorityModal" class="modal-overlay">
                <div class="modal-content-popup">
                    <div class="modal-header-popup">
                        <h3>Editar Tag</h3>
                        <button class="close-modal-btn">&times;</button>
                    </div>
                    <div class="modal-body-popup">
                        <div class="form-group">
                            <label for="editPriorityLabel">Título da Tag</label>
                            <input type="text" id="editPriorityLabel" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Cor</label>
                            <div id="editPriorityColorPicker" class="color-picker">
                                <span class="color-swatch p-gray" data-color-class="p-gray"></span>
                                <span class="color-swatch p-blue" data-color-class="p-blue"></span>
                                <span class="color-swatch p-green" data-color-class="p-green"></span>
                                <span class="color-swatch p-yellow" data-color-class="p-yellow"></span>
                                <span class="color-swatch p-orange" data-color-class="p-orange"></span>
                                <span class="color-swatch p-red" data-color-class="p-red"></span>
                                <span class="color-swatch p-pink" data-color-class="p-pink"></span>
                                <span class="color-swatch p-purple" data-color-class="p-purple"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="editPriorityDescription">Descrição</label>
                            <textarea id="editPriorityDescription" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer-popup">
                        <button id="cancelEditBtn" class="btn btn-secondary">Cancelar</button>
                        <button id="saveEditBtn" class="btn btn-primary">Salvar</button>
                    </div>
                </div>
            </div>

            <div id="deletePriorityModal" class="modal-overlay">
                <div class="modal-content-popup">
                    <div class="modal-header-popup">
                        <h3>Excluir Tag?</h3>
                        <button class="close-modal-btn">&times;</button>
                    </div>
                    <div class="modal-body-popup">
                        <p>Isso irá excluir permanentemente esta Tag do campo "Prioridade". <strong>Isso não pode ser desfeito.</strong></p>
                        <div class="warning-box">
                            A Tag será excluída permanentemente de qualquer item neste projeto.
                        </div>
                    </div>
                    <div class="modal-footer-popup">
                        <button id="cancelDeleteBtn" class="btn btn-secondary">Cancelar</button>
                        <button id="confirmDeleteBtn" class="btn btn-danger">Excluir</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="tamanho" class="tab-pane">
            <h2 class="config-content-title">Tamanho</h2>
            <p>Defina os tamanhos que podem ser atribuídos às tarefas para estimar o esforço.</p>

            <div class="size-settings-container">
                <div class="size-list-header">
                    <span>Opção</span>
                    <span>Descrição</span>
                </div>
                <ul id="size-list" class="size-list">
                    {# Itens pré-existentes, como viriam do seu banco de dados #}
                    <li class="size-item" data-id="xs" draggable="true">
                        <div class="size-handle">::</div>
                        <div class="size-tag-container">
                            <span class="size-tag s-green" data-color-class="s-green">XS</span>
                        </div>
                        <div class="size-description">
                            <input type="text" value="Tarefa muito fácil/simples, que provavelmente deve ser terminada em poucas hours ou questão de minutos" readonly>
                        </div>
                        <button class="size-options-btn">...</button>
                    </li>
                    <li class="size-item" data-id="s" draggable="true">
                        <div class="size-handle">::</div>
                        <div class="size-tag-container">
                            <span class="size-tag s-red" data-color-class="s-red">S</span>
                        </div>
                        <div class="size-description">
                            <input type="text" value="Tarefa fácil, envolve determinada análise mas continua sendo de fácil solução" readonly>
                        </div>
                        <button class="size-options-btn">...</button>
                    </li>
                    <li class="size-item" data-id="m" draggable="true">
                        <div class="size-handle">::</div>
                        <div class="size-tag-container">
                            <span class="size-tag s-blue" data-color-class="s-blue">M</span>
                        </div>
                        <div class="size-description">
                            <input type="text" value="Tarefa mediana, pode ser simples porém será extensa ou exigirá mais atenção e horas trabalhadas" readonly>
                        </div>
                        <button class="size-options-btn">...</button>
                    </li>
                    <li class="size-item" data-id="l" draggable="true">
                        <div class="size-handle">::</div>
                        <div class="size-tag-container">
                            <span class="size-tag s-purple" data-color-class="s-purple">L</span>
                        </div>
                        <div class="size-description">
                            <input type="text" value="Tarefa complicada, exigirá atenção, pesquisa e talvez horas a alguns dias de trabalho" readonly>
                        </div>
                        <button class="size-options-btn">...</button>
                    </li>
                    <li class="size-item" data-id="xl" draggable="true">
                        <div class="size-handle">::</div>
                        <div class="size-tag-container">
                            <span class="size-tag s-orange" data-color-class="s-orange">XL</span>
                        </div>
                        <div class="size-description">
                            <input type="text" value="Tarefa Difícil, faça-a com cuidado, pois o nível de dificuldade é alto e imprevistos podem impactar o tempo de produção ou outras tarefas..." readonly>
                        </div>
                        <button class="size-options-btn">...</button>
                    </li>
                </ul>

                <div class="add-size-form">
                    <input type="text" id="newSizeInput" class="form-control" placeholder="Adicionar nome do tamanho...">
                    <button id="addSizeBtn" class="btn btn-secondary">Adicionar</button>
                </div>
            </div>

            <div id="size-options-menu" class="options-menu">
                <div class="menu-item" id="edit-size-option"><img src="{% static 'public/images/Settings.svg' %}" alt=""> Editar Tag</div>
                <div class="menu-item danger" id="remove-size-option"><img src="{% static 'public/images/Archive.svg' %}" alt=""> Remover Tag</div>
            </div>

            <div id="editSizeModal" class="modal-overlay">
                <div class="modal-content-popup">
                    <div class="modal-header-popup">
                        <h3>Editar Tag</h3>
                        <button class="close-modal-btn">&times;</button>
                    </div>
                    <div class="modal-body-popup">
                        <div class="form-group">
                            <label for="editSizeLabel">Título da Tag</label>
                            <input type="text" id="editSizeLabel" class="form-control">
                        </div>
                        <div class="form-group">
                            <label>Cor</label>
                            <div id="editSizeColorPicker" class="color-picker">
                                <span class="color-swatch s-gray" data-color-class="s-gray"></span>
                                <span class="color-swatch s-blue" data-color-class="s-blue"></span>
                                <span class="color-swatch s-green" data-color-class="s-green"></span>
                                <span class="color-swatch s-orange" data-color-class="s-orange"></span>
                                <span class="color-swatch s-red" data-color-class="s-red"></span>
                                <span class="color-swatch s-purple" data-color-class="s-purple"></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="editSizeDescription">Descrição</label>
                            <textarea id="editSizeDescription" class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer-popup">
                        <button id="cancelEditSizeBtn" class="btn btn-secondary">Cancelar</button>
                        <button id="saveEditSizeBtn" class="btn btn-primary">Salvar</button>
                    </div>
                </div>
            </div>

            <div id="deleteSizeModal" class="modal-overlay">
                <div class="modal-content-popup">
                    <div class="modal-header-popup">
                        <h3>Excluir Tag?</h3>
                        <button class="close-modal-btn">&times;</button>
                    </div>
                    <div class="modal-body-popup">
                        <p>Isso irá excluir permanentemente esta Tag do campo "Tamanho". <strong>Isso não pode ser desfeito.</strong></p>
                        <div class="warning-box">
                            A Tag será excluída permanentemente de qualquer item neste projeto.
                        </div>
                    </div>
                    <div class="modal-footer-popup">
                        <button id="cancelDeleteSizeBtn" class="btn btn-secondary">Cancelar</button>
                        <button id="confirmDeleteSizeBtn" class="btn btn-danger">Excluir</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="iteracao-sprint" class="tab-pane">
            <h2 class="config-content-title">Iteração/Sprint</h2>
            <p>Conteúdo para Iteração/Sprint...</p>
        </div>
        <div id="milestone" class="tab-pane">
            <h2 class="config-content-title">Milestone</h2>
            <p>Conteúdo para Milestone...</p>
        </div>
        <div id="fluxo-trabalho" class="tab-pane">
            <h2 class="config-content-title">Fluxo de trabalho</h2>
            <p>Conteúdo para Fluxo de trabalho...</p>
        </div>
        <div id="arquivados" class="tab-pane">
            <h2 class="config-content-title">Arquivados</h2>
            <p>Conteúdo para Arquivados...</p>
        </div>
    </div>
</div>
{% endblock %}